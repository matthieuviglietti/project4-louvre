<?php

namespace MV\BookingBundle\Repository;

use Doctrine\ORM\QueryBuilder;
/**
 * UserRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class UserRepository extends \Doctrine\ORM\EntityRepository
{
    public function getIdOrder(){
        $characts = 'abcdefghijklmnopqrstuvwxyz'; 
        $characts .= 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';	
        $characts .= '1234567890'; 
        $code_random = ''; 

        for($i=0;$i < 10;$i++) 
        { 
        $code_random .= $characts[ rand() % strlen($characts) ]; 
        } 
        return $code_random;
    }

    public function selectUserOrder($sessionId)
    {
        $qb = $this->createQueryBuilder('u');
        $qb 
            -> where('u.sessionKey = :sessionId')
            -> setParameter('sessionId', $sessionId);

        $listActiveUsers = $qb->getQuery()
                              ->getResult();

        return $listActiveUsers;     
    }

    public function countUserDay($date)
    {
        $qb = $this->createQueryBuilder('u');
        $qb
            -> select('COUNT(u.name)')
            -> where('u.date = :date')
            -> setParameter('date', $date);

        $listVisitors = $qb->getQuery()
                           ->getResult();

        return $listVisitors;
            
    }
}
